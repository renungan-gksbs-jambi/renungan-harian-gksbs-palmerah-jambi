<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Renungan Kristen Harian</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="#manifest">
    <link rel="apple-touch-icon" href="https://images.unsplash.com/photo-1598554747431-56fa52c96383?ixlib=rb-4.0.3&auto=format&fit=crop&w=192&h=192&q=80">
    
    <!-- Meta Tags for PWA -->
    <meta name="theme-color" content="#6a11cb">
    <meta name="description" content="Aplikasi renungan harian dan ilustrasi Alkitab untuk Gereja Kristen Sumatra Bagian Selatan (GKSBS)">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Renungan GKSBS">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }
        .bg-christian {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
        }
        .verse-card {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }
        .verse-card:hover {
            transform: translateY(-5px);
        }
        .bible-icon {
            animation: glow 2s infinite alternate;
        }
        @keyframes glow {
            from {
                text-shadow: 0 0 5px #fff, 0 0 10px #e0e0e0;
            }
            to {
                text-shadow: 0 0 10px #fff, 0 0 20px #a0d8f1, 0 0 30px #6a11cb;
            }
        }
        .daily-devotion {
            animation: fadeInUp 0.8s ease-out;
        }
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .admin-panel {
            position: fixed;
            top: 0;
            right: -320px;
            width: 300px;
            height: 100vh;
            background: white;
            box-shadow: -5px 0 15px rgba(0,0,0,0.1);
            transition: right 0.3s ease;
            z-index: 1000;
            padding: 20px;
            overflow-y: auto;
        }
        .admin-panel.open {
            right: 0;
        }
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }
        .overlay.active {
            display: block;
        }
        .church-logo {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 50%;
            border: 3px solid #fff;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .church-logo:hover {
            transform: scale(1.1);
        }
        .footer-copyright {
            font-size: 0.8rem;
            letter-spacing: 0.5px;
        }
        .logo-preview {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 50%;
            border: 3px solid #6a11cb;
            margin: 10px auto;
            display: block;
        }
        .file-upload {
            border: 2px dashed #ddd;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .file-upload:hover {
            border-color: #6a11cb;
            background-color: #f8f9ff;
        }
        .file-upload p {
            margin: 10px 0 0 0;
            color: #666;
            font-size: 0.9rem;
        }
        .install-button {
            background: linear-gradient(to right, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px 0;
            display: none;
        }
        .history-item {
            border-left: 3px solid #6a11cb;
            padding-left: 15px;
            margin-bottom: 15px;
            position: relative;
        }
        .history-item:before {
            content: "‚Ä¢";
            position: absolute;
            left: -6px;
            top: 5px;
            font-size: 24px;
            color: #6a11cb;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app"></div>
    
    <!-- Load React -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Load Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script type="text/babel">
        // Simpan data di localStorage untuk persistensi
        const STORAGE_KEY = 'gksbs_renungan_data';
        
        // Data awal jika belum ada di localStorage
        const defaultData = {
            logo: 'https://images.unsplash.com/photo-1598554747431-56fa52c96383?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&h=600&q=80',
            devotions: [
                {
                    id: 1,
                    date: new Date().toLocaleDateString('id-ID', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }),
                    title: "Kasih yang Tak Pernah Gagal",
                    verse: "1 Korintus 13:4-8",
                    passage: "Kasih itu sabar, kasih itu murah hati. Ia tidak cemburu. Ia tidak memegahkan diri dan tidak sombong. Ia tidak melakukan yang tidak sopan dan tidak mencari keuntungan sendiri. Ia tidak pemarah dan tidak menyimpan kesalahan. Ia tidak bersukacita karena ketidakadilan, tetapi karena kebenaran. Kasih menutupi segala sesuatu, percaya akan segala sesuatu, mengharapkan segala sesuatu, sabar menanggung segala sesuatu. Kasih tidak berkesudahan.",
                    reflection: "Dalam dunia yang sering kali penuh dengan ego dan persaingan, kasih yang diajarkan oleh Alkitab menjadi pedoman hidup kita. Kasih sejati bukan sekadar perasaan, melainkan tindakan nyata yang sabar, pengertian, dan tanpa pamrih. Mari kita renungkan bagaimana kita bisa menerapkan kasih ini dalam keseharian kita terhadap keluarga, teman, bahkan orang asing.",
                    prayer: "Tuhan Yesus, ajarlah kami untuk mengasihi seperti Engkau mengasihi kami. Berikan kami hati yang sabar, lembut, dan murah hati. Tolong kami untuk tidak mudah marah atau menyimpan dendam. Jadikan kasih-Mu mengalir melalui hidup kami setiap hari. Dalam nama Yesus, kami berdoa. Amin."
                },
                {
                    id: 2,
                    date: new Date(new Date().setDate(new Date().getDate() - 1)).toLocaleDateString('id-ID', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }),
                    title: "Damai Sejahtera yang Melampaui Akal",
                    verse: "Filipi 4:6-7",
                    passage: "Janganlah hendaknya kamu kuatir tentang apa pun juga, tetapi nyatakanlah dalam segala hal keinginanmu kepada Allah dalam doa dan permohonan dengan ucapan syukur. Damai sejahtera Allah, yang melampaui segala akal, akan memelihara hati dan pikiranmu dalam Kristus Yesus.",
                    reflection: "Kekhawatiran adalah tantangan yang sering kita hadapi dalam kehidupan modern. Namun, Firman Tuhan mengajarkan kita untuk membawa semua pergumulan kita kepada-Nya melalui doa. Ketika kita menyerahkan beban kita kepada Tuhan, Dia memberikan damai sejahtera yang tidak bisa dijelaskan oleh logika manusia.",
                    prayer: "Bapa Surgawi, terima kasih untuk janji-Mu tentang damai sejahtera. Saat aku merasa cemas, ingatkan aku untuk datang kepada-Mu dalam doa dengan hati yang bersyukur. Biarkan damai-Mu yang melampaui akal budi memelihara hati dan pikiranku. Dalam nama Yesus, aku percaya. Amin."
                }
            ],
            illustrations: [
                {
                    id: 1,
                    title: "Yesus Menenangkan Angin Ribut",
                    reference: "Markus 4:35-41",
                    image: "https://placehold.co/400x300/4F46E5/FFFFFF?text=Yesus+Menenangkan+Angin+Ribut",
                    description: "Gambaran Yesus yang tenang di tengah badai mengajarkan kita bahwa Ia hadir bahkan dalam pergumulan terberat kita. Ketika iman kita goyah, Dia siap menenangkan hati kita seperti Ia menenangkan lautan."
                },
                {
                    id: 2,
                    title: "Daud dan Goliat",
                    reference: "1 Samuel 17",
                    image: "https://placehold.co/400x300/059669/FFFFFF?text=Daud+vs+Goliat",
                    description: "Ilustrasi ini menggambarkan kemenangan iman atas ketakutan. Daud tidak melihat ukuran musuh, tetapi melihat besarnya Tuhan yang menyertainya. Demikian juga kita, dengan iman, bisa mengalahkan 'raksasa' dalam hidup kita."
                }
            ]
        };

        // Ambil data dari localStorage atau gunakan default
        const savedData = JSON.parse(localStorage.getItem(STORAGE_KEY)) || defaultData;
        let devotions = savedData.devotions;
        let bibleIllustrations = savedData.illustrations;
        let currentLogo = savedData.logo;

        // App component
        function App() {
            const [currentDevotion, setCurrentDevotion] = React.useState(devotions[0]);
            const [illustration, setIllustration] = React.useState(bibleIllustrations[0]);
            const [activeTab, setActiveTab] = React.useState('devotion');
            const [activeContent, setActiveContent] = React.useState('main'); // main, history, share
            const [notificationEnabled, setNotificationEnabled] = React.useState(false);
            const [showAdminPanel, setShowAdminPanel] = React.useState(false);
            const [adminPassword, setAdminPassword] = React.useState('');
            const [isAuthenticated, setIsAuthenticated] = React.useState(false);

            // Form states
            const [newDevotion, setNewDevotion] = React.useState({
                title: '',
                verse: '',
                passage: '',
                reflection: '',
                prayer: ''
            });
            const [newIllustration, setNewIllustration] = React.useState({
                title: '',
                reference: '',
                image: '',
                description: ''
            });

            // Logo state
            const [churchLogo, setChurchLogo] = React.useState(currentLogo);
            const [logoFile, setLogoFile] = React.useState(null);
            const [logoPreview, setLogoPreview] = React.useState(currentLogo);

            // PWA states
            const [deferredPrompt, setDeferredPrompt] = React.useState(null);
            const [showInstallButton, setShowInstallButton] = React.useState(false);

            // Simulate real-time updates
            React.useEffect(() => {
                const interval = setInterval(() => {
                    if (devotions.length > 0) {
                        const randomDevotion = devotions[Math.floor(Math.random() * devotions.length)];
                        setCurrentDevotion(randomDevotion);
                    }
                    if (bibleIllustrations.length > 0) {
                        const randomIllustration = bibleIllustrations[Math.floor(Math.random() * bibleIllustrations.length)];
                        setIllustration(randomIllustration);
                    }
                }, 300000); // Update every 5 minutes

                return () => clearInterval(interval);
            }, []);

            // PWA installation handler
            React.useEffect(() => {
                const handleBeforeInstallPrompt = (e) => {
                    e.preventDefault();
                    setDeferredPrompt(e);
                    setShowInstallButton(true);
                };

                window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);

                // Check if app is already installed
                window.addEventListener('appinstalled', () => {
                    setShowInstallButton(false);
                    setDeferredPrompt(null);
                });

                return () => {
                    window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);
                };
            }, []);

            const toggleNotification = () => {
                setNotificationEnabled(!notificationEnabled);
                alert(notificationEnabled ? 
                    "Notifikasi renungan harian dinonaktifkan" : 
                    "Notifikasi renungan harian diaktifkan! Anda akan menerima pemberitahuan setiap pagi.");
            };

            const openAdminPanel = () => {
                setShowAdminPanel(true);
            };

            const closeAdminPanel = () => {
                setShowAdminPanel(false);
                setAdminPassword('');
                setIsAuthenticated(false);
            };

            const authenticate = () => {
                // Simple password check
                if (adminPassword === 'renungan123') {
                    setIsAuthenticated(true);
                    alert('Autentikasi berhasil! Anda sekarang dapat mengupdate konten.');
                } else {
                    alert('Password salah! Silakan coba lagi.');
                }
            };

            const handleDevotionChange = (e) => {
                setNewDevotion({
                    ...newDevotion,
                    [e.target.name]: e.target.value
                });
            };

            const handleIllustrationChange = (e) => {
                setNewIllustration({
                    ...newIllustration,
                    [e.target.name]: e.target.value
                });
            };

            const addNewDevotion = () => {
                if (!newDevotion.title || !newDevotion.verse || !newDevotion.passage) {
                    alert('Mohon lengkapi judul, ayat, dan kutipan!');
                    return;
                }

                const devotion = {
                    id: Date.now(),
                    date: new Date().toLocaleDateString('id-ID', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }),
                    ...newDevotion
                };

                devotions.unshift(devotion);
                setCurrentDevotion(devotion);
                
                // Simpan ke localStorage
                const updatedData = { ...savedData, devotions: devotions };
                localStorage.setItem(STORAGE_KEY, JSON.stringify(updatedData));
                
                setNewDevotion({ title: '', verse: '', passage: '', reflection: '', prayer: '' });
                alert('Renungan baru berhasil ditambahkan dan disimpan!');
            };

            const addNewIllustration = () => {
                if (!newIllustration.title || !newIllustration.reference || !newIllustration.description) {
                    alert('Mohon lengkapi judul, referensi, dan deskripsi!');
                    return;
                }

                const illustration = {
                    id: Date.now(),
                    image: newIllustration.image || 'https://placehold.co/400x300/4F46E5/FFFFFF?text=Ilustrasi+Alkitab',
                    ...newIllustration
                };

                bibleIllustrations.unshift(illustration);
                setIllustration(illustration);
                
                // Simpan ke localStorage
                const updatedData = { ...savedData, illustrations: bibleIllustrations };
                localStorage.setItem(STORAGE_KEY, JSON.stringify(updatedData));
                
                setNewIllustration({ title: '', reference: '', image: '', description: '' });
                alert('Ilustrasi Alkitab baru berhasil ditambahkan dan disimpan!');
            };

            const handleLogoClick = () => {
                document.getElementById('logoUpload').click();
            };

            const handleLogoChange = (e) => {
                const file = e.target.files[0];
                if (file) {
                    setLogoFile(file);
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        setLogoPreview(e.target.result);
                    };
                    reader.readAsDataURL(file);
                }
            };

            const saveLogo = () => {
                if (logoFile) {
                    // Simpan ke localStorage
                    const updatedData = { ...savedData, logo: logoPreview };
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(updatedData));
                    
                    setChurchLogo(logoPreview);
                    alert('Logo berhasil diperbarui dan disimpan untuk semua sesi!');
                } else {
                    alert('Silakan pilih file logo terlebih dahulu.');
                }
            };

            const resetLogo = () => {
                const defaultLogo = 'https://imgbox.com/nlvz6CO7';
                
                // Simpan default ke localStorage
                const updatedData = { ...savedData, logo: defaultLogo };
                localStorage.setItem(STORAGE_KEY, JSON.stringify(updatedData));
                
                setChurchLogo(defaultLogo);
                setLogoPreview(defaultLogo);
                setLogoFile(null);
                document.getElementById('logoUpload').value = '';
                alert('Logo telah direset ke default dan disimpan.');
            };

            const installApp = () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    deferredPrompt.userChoice.then((choiceResult) => {
                        if (choiceResult.outcome === 'accepted') {
                            console.log('User accepted the install prompt');
                            setShowInstallButton(false);
                        } else {
                            console.log('User dismissed the install prompt');
                        }
                        setDeferredPrompt(null);
                    });
                }
            };

            // Fungsi Bagikan yang diperbaiki
            const shareContent = () => {
                const title = activeTab === 'devotion' ? currentDevotion.title : illustration.title;
                const text = activeTab === 'devotion' ? 
                    `Renungan: ${currentDevotion.title}\n\n${currentDevotion.reflection}\n\n${currentDevotion.verse}` :
                    `Ilustrasi: ${illustration.title}\n\n${illustration.description}\n\n${illustration.reference}`;
                
                const url = window.location.href;

                if (navigator.share && navigator.canShare) {
                    try {
                        navigator.share({
                            title: title,
                            text: text,
                            url: url
                        }).then(() => {
                            setActiveContent('main');
                        }).catch((error) => {
                            console.log('Error sharing:', error);
                            fallbackShare(title, text, url);
                        });
                    } catch (err) {
                        fallbackShare(title, text, url);
                    }
                } else {
                    fallbackShare(title, text, url);
                }
            };

            // Fallback jika Web Share API tidak tersedia
            const fallbackShare = (title, text, url) => {
                const shareText = `${text}\n\n${url}`;
                const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(shareText)}`;
                
                if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                    window.open(whatsappUrl, '_blank');
                } else {
                    prompt('Salin teks berikut untuk dibagikan:', shareText);
                }
                
                setActiveContent('main');
            };

            // Kembali ke konten utama
            const goBack = () => {
                setActiveContent('main');
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
                    {/* Header */}
                    <header className="bg-christian text-white shadow-lg">
                        <div className="container mx-auto px-4 py-6">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center space-x-4">
                                    {/* Logo Gereja Klasik Realistik */}
                                    <img 
                                        src={churchLogo} 
                                        alt="Logo Gereja"
                                        className="church-logo"
                                        onClick={handleLogoClick}
                                    />
                                    <div>
                                        <h1 className="text-2xl font-bold">Renungan Kristen</h1>
                                        <p className="text-sm opacity-90">Gereja Kristen Sumatra Bagian Selatan (GKSBS)</p>
                                    </div>
                                </div>
                                <div className="flex items-center space-x-2">
                                    <button 
                                        onClick={toggleNotification}
                                        className={`px-3 py-1 rounded-full text-sm font-medium transition-all ${
                                            notificationEnabled 
                                                ? 'bg-yellow-400 text-yellow-900' 
                                                : 'bg-white bg-opacity-20 text-white hover:bg-opacity-30'
                                        }`}
                                    >
                                        {notificationEnabled ? 'üîî Aktif' : 'üîï Mati'}
                                    </button>
                                    <button 
                                        onClick={openAdminPanel}
                                        className="px-3 py-1 bg-white bg-opacity-20 text-white rounded-full text-sm font-medium hover:bg-opacity-30"
                                    >
                                        ‚öôÔ∏è Admin
                                    </button>
                                </div>
                            </div>
                        </div>
                    </header>

                    {/* Navigation Tabs */}
                    {activeContent === 'main' && (
                        <div className="container mx-auto px-4 mt-6">
                            <div className="flex bg-white rounded-2xl shadow-md p-1 max-w-md mx-auto">
                                <button
                                    onClick={() => setActiveTab('devotion')}
                                    className={`flex-1 py-3 px-6 rounded-xl font-medium transition-all ${
                                        activeTab === 'devotion'
                                            ? 'bg-indigo-600 text-white shadow-md'
                                            : 'text-gray-600 hover:text-indigo-600'
                                    }`}
                                >
                                    Renungan
                                </button>
                                <button
                                    onClick={() => setActiveTab('illustration')}
                                    className={`flex-1 py-3 px-6 rounded-xl font-medium transition-all ${
                                        activeTab === 'illustration'
                                            ? 'bg-indigo-600 text-white shadow-md'
                                            : 'text-gray-600 hover:text-indigo-600'
                                    }`}
                                >
                                    Ilustrasi
                                </button>
                            </div>
                        </div>
                    )}

                    {/* Main Content */}
                    {activeContent === 'main' && (
                        <main className="container mx-auto px-4 py-8">
                            {activeTab === 'devotion' ? (
                                <div className="daily-devotion">
                                    <div className="bg-white rounded-3xl shadow-xl verse-card overflow-hidden mb-8">
                                        <div className="bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-4">
                                            <h2 className="text-2xl font-bold text-white">{currentDevotion.title}</h2>
                                            <p className="text-indigo-100 mt-1">{currentDevotion.date}</p>
                                        </div>
                                        
                                        <div className="p-6">
                                            <div className="bg-gradient-to-r from-yellow-50 to-orange-50 border-l-4 border-yellow-400 p-4 rounded-r-lg mb-6">
                                                <p className="text-gray-800 font-medium italic">"{currentDevotion.passage}"</p>
                                                <p className="text-indigo-700 font-semibold mt-2">{currentDevotion.verse}</p>
                                            </div>
                                            
                                            <div className="space-y-4">
                                                <div>
                                                    <h3 className="text-lg font-semibold text-gray-800 mb-2">Renungan:</h3>
                                                    <p className="text-gray-700 leading-relaxed">{currentDevotion.reflection}</p>
                                                </div>
                                                
                                                <div>
                                                    <h3 className="text-lg font-semibold text-gray-800 mb-2">Doa:</h3>
                                                    <p className="text-gray-700 leading-relaxed italic">"{currentDevotion.prayer}"</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    {/* Action Buttons */}
                                    <div className="flex space-x-4">
                                        <button 
                                            onClick={() => setActiveContent('share')}
                                            className="flex-1 bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-6 rounded-2xl transition-colors flex items-center justify-center space-x-2"
                                        >
                                            <span>üì§</span>
                                            <span>Bagikan</span>
                                        </button>
                                        <button 
                                            onClick={() => setActiveContent('history')}
                                            className="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-6 rounded-2xl transition-colors flex items-center justify-center space-x-2"
                                        >
                                            <span>üìÖ</span>
                                            <span>Riwayat</span>
                                        </button>
                                    </div>
                                </div>
                            ) : (
                                <div className="daily-devotion">
                                    <div className="bg-white rounded-3xl shadow-xl overflow-hidden">
                                        <img 
                                            src={illustration.image} 
                                            alt={illustration.title}
                                            className="w-full h-64 object-cover"
                                        />
                                        <div className="p-6">
                                            <h2 className="text-2xl font-bold text-gray-800 mb-2">{illustration.title}</h2>
                                            <p className="text-indigo-600 font-semibold mb-4">{illustration.reference}</p>
                                            <p className="text-gray-700 leading-relaxed mb-6">{illustration.description}</p>
                                            
                                            <div className="bg-blue-50 border border-blue-200 rounded-xl p-4">
                                                <h3 className="font-semibold text-blue-800 mb-2">üîç Makna Spiritual:</h3>
                                                <p className="text-blue-700 text-sm">
                                                    Ilustrasi ini mengajarkan kita tentang {illustration.title.toLowerCase().includes('yesus') ? 'kekuatan iman dan kedamaian yang hanya bisa diberikan oleh Tuhan' : 
                                                       illustration.title.toLowerCase().includes('daud') ? 'pentingnya mempercayai Tuhan meskipun menghadapi tantangan besar' : 
                                                       'kasih karunia dan pengampunan yang tak terbatas dari Bapa Surgawi'}.
                                                </p>
                                            </div>
                                        </div>
                                    </div>

                                    {/* Action Buttons */}
                                    <div className="flex space-x-4 mt-6">
                                        <button 
                                            onClick={() => setActiveContent('share')}
                                            className="flex-1 bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-6 rounded-2xl transition-colors flex items-center justify-center space-x-2"
                                        >
                                            <span>üì§</span>
                                            <span>Bagikan</span>
                                        </button>
                                        <button 
                                            onClick={() => setActiveContent('history')}
                                            className="flex-1 bg-purple-600 hover:bg-purple-700 text-white font-medium py-3 px-6 rounded-2xl transition-colors flex items-center justify-center space-x-2"
                                        >
                                            <span>üìÖ</span>
                                            <span>Riwayat</span>
                                        </button>
                                    </div>
                                </div>
                            )}
                        </main>
                    )}

                    {/* Share Content */}
                    {activeContent === 'share' && (
                        <div className="container mx-auto px-4 py-8">
                            <div className="bg-white rounded-3xl shadow-xl p-6 max-w-md mx-auto">
                                <div className="flex items-center justify-between mb-6">
                                    <h2 className="text-xl font-bold text-gray-800">Bagikan Konten</h2>
                                    <button 
                                        onClick={goBack}
                                        className="text-gray-500 hover:text-gray-700 text-2xl"
                                    >
                                        √ó
                                    </button>
                                </div>
                                
                                <div className="space-y-4">
                                    <p className="text-gray-700">
                                        Pilih cara untuk membagikan renungan ini:
                                    </p>
                                    
                                    <div className="space-y-3">
                                        <button 
                                            onClick={shareContent}
                                            className="w-full bg-green-600 hover:bg-green-700 text-white text-left p-4 rounded-xl transition-colors flex items-center space-x-3"
                                        >
                                            <span className="text-2xl">üì±</span>
                                            <span>Bagikan via Aplikasi</span>
                                        </button>
                                        
                                        <a 
                                            href={`https://wa.me/?text=${encodeURIComponent(
                                                activeTab === 'devotion' ? 
                                                `*Renungan Kristen GKSBS*\n\n${currentDevotion.title}\n\n"${currentDevotion.passage}"\n${currentDevotion.verse}\n\n${currentDevotion.reflection}\n\n${currentDevotion.prayer}\n\n${window.location.href}` :
                                                `*Ilustrasi Alkitab GKSBS*\n\n${illustration.title}\n\n${illustration.description}\n\n${illustration.reference}\n\n${window.location.href}`
                                            )}`}
                                            target="_blank"
                                            rel="noopener noreferrer"
                                            className="block w-full bg-green-500 hover:bg-green-600 text-white text-left p-4 rounded-xl transition-colors text-center"
                                        >
                                            WhatsApp
                                        </a>
                                        
                                        <a 
                                            href={`mailto:?subject=Renungan Kristen GKSBS&body=${encodeURIComponent(
                                                activeTab === 'devotion' ? 
                                                `Lihat renungan hari ini:\n\n${currentDevotion.title}\n\n"${currentDevotion.passage}"\n${currentDevotion.verse}\n\n${currentDevotion.reflection}\n\n${currentDevotion.prayer}\n\n${window.location.href}` :
                                                `Lihat ilustrasi Alkitab hari ini:\n\n${illustration.title}\n\n${illustration.description}\n\n${illustration.reference}\n\n${window.location.href}`
                                            )}`}
                                            className="block w-full bg-blue-500 hover:bg-blue-600 text-white text-left p-4 rounded-xl transition-colors text-center"
                                        >
                                            Email
                                        </a>
                                    </div>
                                    
                                    <button 
                                        onClick={goBack}
                                        className="w-full bg-gray-500 hover:bg-gray-600 text-white p-3 rounded-xl transition-colors"
                                    >
                                        Kembali
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* History Content */}
                    {activeContent === 'history' && (
                        <div className="container mx-auto px-4 py-8">
                            <div className="bg-white rounded-3xl shadow-xl p-6 max-w-3xl mx-auto">
                                <div className="flex items-center justify-between mb-6">
                                    <h2 className="text-xl font-bold text-gray-800">Riwayat Renungan</h2>
                                    <button 
                                        onClick={goBack}
                                        className="text-gray-500 hover:text-gray-700 text-2xl"
                                    >
                                        √ó
                                    </button>
                                </div>
                                
                                <div className="space-y-6">
                                    {activeTab === 'devotion' ? (
                                        <>
                                            <h3 className="text-lg font-semibold text-gray-800">Renungan Terdahulu</h3>
                                            {devotions.slice(1, 6).map((devotion, index) => (
                                                <div key={devotion.id} className="history-item">
                                                    <h4 className="font-semibold text-gray-800">{devotion.title}</h4>
                                                    <p className="text-sm text-gray-600 mb-1">{devotion.date}</p>
                                                    <p className="text-sm text-gray-700 italic">"{devotion.verse}"</p>
                                                    <p className="text-gray-600 text-sm mt-1">{devotion.reflection.substring(0, 100)}...</p>
                                                </div>
                                            ))}
                                        </>
                                    ) : (
                                        <>
                                            <h3 className="text-lg font-semibold text-gray-800">Ilustrasi Terdahulu</h3>
                                            {bibleIllustrations.slice(1, 6).map((ill, index) => (
                                                <div key={ill.id} className="history-item">
                                                    <h4 className="font-semibold text-gray-800">{ill.title}</h4>
                                                    <p className="text-sm text-gray-600 mb-1">{ill.reference}</p>
                                                    <p className="text-gray-600 text-sm mt-1">{ill.description.substring(0, 100)}...</p>
                                                </div>
                                            ))}
                                        </>
                                    )}
                                    
                                    <button 
                                        onClick={goBack}
                                        className="w-full bg-gray-500 hover:bg-gray-600 text-white p-3 rounded-xl transition-colors"
                                    >
                                        Kembali
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Admin Panel */}
                    <div className={`admin-panel ${showAdminPanel ? 'open' : ''}`}>
                        <div className="flex justify-between items-center mb-6">
                            <h3 className="text-xl font-bold text-gray-800">Panel Admin</h3>
                            <button 
                                onClick={closeAdminPanel}
                                className="text-gray-500 hover:text-gray-700 text-2xl"
                            >
                                √ó
                            </button>
                        </div>

                        {!isAuthenticated ? (
                            <div className="space-y-4">
                                <h4 className="font-semibold text-gray-700">Masuk sebagai Admin</h4>
                                <input
                                    type="password"
                                    value={adminPassword}
                                    onChange={(e) => setAdminPassword(e.target.value)}
                                    placeholder="Masukkan password admin"
                                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                />
                                <button
                                    onClick={authenticate}
                                    className="w-full bg-indigo-600 text-white py-2 rounded-lg hover:bg-indigo-700 transition-colors"
                                >
                                    Masuk
                                </button>
                            </div>
                        ) : (
                            <div className="space-y-6">
                                <div>
                                    <h4 className="font-semibold text-gray-800 mb-3">Kelola Logo Gereja</h4>
                                    <div className="text-center">
                                        <img 
                                            src={logoPreview} 
                                            alt="Pratinjau Logo" 
                                            className="logo-preview" 
                                        />
                                        <p className="text-sm text-gray-600 mb-3">Klik logo untuk mengganti</p>
                                        <input
                                            id="logoUpload"
                                            type="file"
                                            accept="image/*"
                                            onChange={handleLogoChange}
                                            className="hidden"
                                        />
                                        <div 
                                            className="file-upload"
                                            onClick={handleLogoClick}
                                        >
                                            <p>üìÅ Pilih File Logo</p>
                                            <p>Format: JPG, PNG, GIF (Max 2MB)</p>
                                        </div>
                                        {logoFile && (
                                            <div className="mt-4 space-y-2">
                                                <p className="text-sm text-green-600">File terpilih: {logoFile.name}</p>
                                                <button
                                                    onClick={saveLogo}
                                                    className="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-colors"
                                                >
                                                    üíæ Simpan Perubahan
                                                </button>
                                                <button
                                                    onClick={resetLogo}
                                                    className="w-full bg-gray-600 text-white py-2 rounded-lg hover:bg-gray-700 transition-colors"
                                                >
                                                    üîÑ Reset ke Default
                                                </button>
                                            </div>
                                        )}
                                    </div>
                                </div>

                                <hr className="my-6" />

                                <div>
                                    <h4 className="font-semibold text-gray-800 mb-3">Tambah Renungan Baru</h4>
                                    <div className="space-y-2">
                                        <input
                                            type="text"
                                            name="title"
                                            value={newDevotion.title}
                                            onChange={handleDevotionChange}
                                            placeholder="Judul Renungan"
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                        />
                                        <input
                                            type="text"
                                            name="verse"
                                            value={newDevotion.verse}
                                            onChange={handleDevotionChange}
                                            placeholder="Ayat Alkitab (contoh: Yohanes 3:16)"
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                        />
                                        <textarea
                                            name="passage"
                                            value={newDevotion.passage}
                                            onChange={handleDevotionChange}
                                            placeholder="Kutipan Alkitab"
                                            rows="3"
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                        ></textarea>
                                        <textarea
                                            name="reflection"
                                            value={newDevotion.reflection}
                                            onChange={handleDevotionChange}
                                            placeholder="Renungan/Homili"
                                            rows="4"
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                        ></textarea>
                                        <textarea
                                            name="prayer"
                                            value={newDevotion.prayer}
                                            onChange={handleDevotionChange}
                                            placeholder="Doa Penutup"
                                            rows="3"
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                        ></textarea>
                                        <button
                                            onClick={addNewDevotion}
                                            className="w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition-colors"
                                        >
                                            Tambah Renungan
                                        </button>
                                    </div>
                                </div>

                                <div>
                                    <h4 className="font-semibold text-gray-800 mb-3">Tambah Ilustrasi Alkitab</h4>
                                    <div className="space-y-2">
                                        <input
                                            type="text"
                                            name="title"
                                            value={newIllustration.title}
                                            onChange={handleIllustrationChange}
                                            placeholder="Judul Ilustrasi"
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                        />
                                        <input
                                            type="text"
                                            name="reference"
                                            value={newIllustration.reference}
                                            onChange={handleIllustrationChange}
                                            placeholder="Referensi Alkitab"
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                        />
                                        <input
                                            type="text"
                                            name="image"
                                            value={newIllustration.image}
                                            onChange={handleIllustrationChange}
                                            placeholder="URL Gambar (opsional)"
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                        />
                                        <textarea
                                            name="description"
                                            value={newIllustration.description}
                                            onChange={handleIllustrationChange}
                                            placeholder="Deskripsi Ilustrasi"
                                            rows="4"
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                        ></textarea>
                                        <button
                                            onClick={addNewIllustration}
                                            className="w-full bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700 transition-colors"
                                        >
                                            Tambah Ilustrasi
                                        </button>
                                    </div>
                                </div>

                                <div className="pt-4 border-t">
                                    <h5 className="font-semibold text-gray-700 mb-2">Petunjuk Penggunaan:</h5>
                                    <ul className="text-sm text-gray-600 space-y-1">
                                        <li>‚Ä¢ Klik "Admin" untuk membuka panel kontrol</li>
                                        <li>‚Ä¢ Gunakan password: renungan123</li>
                                        <li>‚Ä¢ Tambahkan renungan atau ilustrasi baru</li>
                                        <li>‚Ä¢ Konten baru akan langsung muncul</li>
                                    </ul>
                                </div>
                            </div>
                        )}
                    </div>

                    {/* Overlay */}
                    <div 
                        className={`overlay ${showAdminPanel ? 'active' : ''}`} 
                        onClick={closeAdminPanel}
                    ></div>

                    {/* Install Button for PWA */}
                    {showInstallButton && (
                        <div className="fixed bottom-20 left-1/2 transform -translate-x-1/2 bg-white p-4 rounded-lg shadow-lg max-w-xs text-center">
                            <h4 className="font-bold text-gray-800 mb-2">Instal Aplikasi Ini</h4>
                            <p className="text-sm text-gray-600 mb-3">Tambahkan ke layar utama Anda untuk akses cepat!</p>
                            <button 
                                onClick={installApp}
                                className="install-button w-full"
                            >
                                üîΩ Instal Aplikasi
                            </button>
                        </div>
                    )}

                    {/* Footer */}
                    <footer className="bg-gray-800 text-white mt-12">
                        <div className="container mx-auto px-4 py-8">
                            <div className="text-center">
                                <div className="text-3xl bible-icon mb-4">‚úùÔ∏è</div>
                                <h3 className="text-xl font-bold mb-2">Tetap Terhubung dengan Firman Tuhan</h3>
                                <p className="text-gray-300 mb-6">Aplikasi ini menyediakan renungan harian dan ilustrasi Alkitab secara real-time.</p>
                                
                                <div className="flex justify-center space-x-6 text-sm text-gray-400">
                                    <span>üì± Akses di HP Android & iOS</span>
                                    <span>|</span>
                                    <span>‚è∞ Update Real-time</span>
                                    <span>|</span>
                                    <span>üîî Notifikasi Harian</span>
                                </div>
                                
                                <div className="mt-8 pt-6 border-t border-gray-700">
                                    <p className="footer-copyright text-gray-400">
                                        ¬© 2025, Tim PWG GKSBS Palmerah-Jambi
                                    </p>
                                </div>
                            </div>
                        </div>
                    </footer>
                </div>
            );
        }

        // Render the app
        const container = document.getElementById('app');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);

        // Service Worker Registration for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js').then(registration => {
                    console.log('SW registered: ', registration);
                }).catch(registrationError => {
                    console.log('SW registration failed: ', registrationError);
                });
            });
        }

        // Create manifest.json dynamically
        const manifest = {
            "name": "Renungan Kristen GKSBS",
            "short_name": "Renungan GKSBS",
            "description": "Aplikasi renungan harian dan ilustrasi Alkitab",
            "start_url": ".",
            "display": "standalone",
            "background_color": "#6a11cb",
            "theme_color": "#6a11cb",
            "orientation": "portrait",
            "icons": [
                {
                    "src": "https://images.unsplash.com/photo-1598554747431-56fa52c96383?ixlib=rb-4.0.3&auto=format&fit=crop&w=192&h=192&q=80",
                    "sizes": "192x192",
                    "type": "image/png"
                },
                {
                    "src": "https://images.unsplash.com/photo-1598554747431-56fa52c96383?ixlib=rb-4.0.3&auto=format&fit=crop&w=512&h=512&q=80",
                    "sizes": "512x512",
                    "type": "image/png"
                }
            ]
        };

        // Create service worker dynamically
        const swScript = `
            const CACHE_NAME = 'renungan-gksbs-v1';
            const urlsToCache = [
                '.',
                '/index.html',
                'https://cdn.tailwindcss.com',
                'https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap'
            ];

            self.addEventListener('install', event => {
                event.waitUntil(
                    caches.open(CACHE_NAME)
                        .then(cache => {
                            return cache.addAll(urlsToCache);
                        })
                );
            });

            self.addEventListener('fetch', event => {
                event.respondWith(
                    caches.match(event.request)
                        .then(response => {
                            if (response) {
                                return response;
                            }
                            return fetch(event.request);
                        })
                );
            });
        `;

        // Create blob for service worker
        const blob = new Blob([swScript], {type: 'application/javascript'});
        const swUrl = URL.createObjectURL(blob);
        
        // This would normally be a separate file, but for demo purposes
        console.log("PWA setup complete. Users can now install this app on their devices.");
    </script>

    <!-- Dynamic manifest -->
    <script type="application/json" id="manifest">
        {"name":"Renungan Kristen GKSBS","short_name":"Renungan GKSBS","description":"Aplikasi renungan harian dan ilustrasi Alkitab","start_url":".","display":"standalone","background_color":"#6a11cb","theme_color":"#6a11cb","orientation":"portrait","icons":[{"src":"https://images.unsplash.com/photo-1598554747431-56fa52c96383?ixlib=rb-4.0.3&auto=format&fit=crop&w=192&h=192&q=80","sizes":"192x192","type":"image/png"},{"src":"https://images.unsplash.com/photo-1598554747431-56fa52c96383?ixlib=rb-4.0.3&auto=format&fit=crop&w=512&h=512&q=80","sizes":"512x512","type":"image/png"}]}
    </script>
</body>
</html>
